<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Techunifi is your all-in-one solution for commercial IT needs, including low-voltage structured cabling, telecom PBX systems, security systems, lighting, distributed and pro AV systems, network Wi-Fi solutions, EV charging, and managed IT solutions."><meta name="keywords" content="security solutions, telecommunication systems, PBX, VoIP, SIP, ISP, low voltage systems, structured cabling, fiber optic networks, network solutions, WiFi installation, speaker installation, lighting systems, smart thermostats, EV chargers, IT solutions"><meta id="desktop_og_image" property="og:image" content="https://www.techunifi.com/assets/img/desktop-og-image.png"><meta id="desktop_og_image_secure_url" property="og:image:secure_url" content="https://www.techunifi.com/assets/img/desktop-og-image.png"><meta id="desktop_twitter_image" name="twitter:image" content="https://www.techunifi.com/assets/img/desktop-og-image.png"><meta id="mobile_og_image" property="og:image" content="https://www.techunifi.com/assets/img/mobile-og-image.png"><meta id="mobile_og_image_secure_url" property="og:image:secure_url" content="https://www.techunifi.com/assets/img/mobile-og-image.png-og-image.png"><meta id="mobile_twitter_image" name="twitter:image" content="https://www.techunifi.com/assets/img/mobile-og-image.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="200"><meta property="og:image:height" content="200"><meta property="og:url" content="https://www.techunifi.com/submit.html"><meta property="og:title" content="Smart Technology IT solutions in High Point, NC - Techunifi"><meta property="og:description" content="Techunifi is your all-in-one solution for commercial IT needs, including low-voltage structured cabling, telecom PBX systems, security systems, lighting, distributed and pro AV systems, network Wi-Fi solutions, EV charging, and managed IT solutions."><meta http-equiv="Content-type" content="text/html; charset=UTF-8"><title>Timesheet</title><link rel="canonical" href="https://www.techunifi.com/submit.html"><link rel="alternate" hreflang="en" href="https://www.techunifi.com/submit.html"><link href="assets/img/favicon.png" rel="icon"><link href="assets/img/favicon.png" rel="apple-touch-icon"><link href="assets/vendor/aos/aos.css" rel="stylesheet"><link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"><link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet"><link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet"><link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet"><link href="assets/css/style.css" rel="stylesheet"><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script><script src="https://www.google.com/recaptcha/api.js"></script><script type="application/ld+json">{
      "@context": "https://schema.org",
      "@type": "Place",
      "name": "Techunifi",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "2638 Willard Dairy Rd",
        "addressLocality": "High Point",
        "addressRegion": "North Carolina",
        "postalCode": "27265",
        "addressCountry": " United States"
      }
    }</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-CKH6XB0EMD"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-CKH6XB0EMD")</script><style>.timePage .hidden-file-input{display:none}.timePage .attach-receipt-button{display:inline-flex;align-items:center;padding:9px 18px 10px;display:inline-block;margin:22px 0 0;cursor:pointer;background-color:var(--orange);color:#fff;border-radius:50px}.timePage .attach-receipt-button:hover{background-color:var(--orange)}.timePage .attach-receipt-button .button-icon{width:20px;height:20px;margin-right:8px}</style></head><body class="submitPage timePage" id="submit-captcha"><header id="nav-menu" class="header-nav" aria-label="navigation bar"><div class="container"><div class="nav-start"><a class="logo" href="https://www.techunifi.com/"><img src="assets/img/logo.png" title="techunifi" alt="Logo"></a><nav class="menu"><ul class="menu-bar"><li><a class="nav-link services" href="https://www.techunifi.com/timesheet.html" onclick="toggleUnderline(event)">Timesheet</a></li><li><a class="nav-link howit-Works" href="https://www.techunifi.com/submit.html" onclick="toggleUnderline(event)">Submit A Ticket</a></li><li><a class="nav-link menu-contact" href="https://www.techunifi.com/new-inquiry.html" onclick="toggleUnderline(event)">Contact Us</a></li><li><a class="nav-link menu-contact" href="https://www.techunifi.com/brands.html" onclick="toggleUnderline(event)">Our Brand</a></li></ul></nav></div><div class="nav-end"><a class="nav-link raise-btn" href="https://www.techunifi.com/">Website</a><button id="hamburger" aria-label="hamburger" aria-haspopup="true" aria-expanded="false"><i class="bx bx-menu" aria-hidden="true"></i></button></div></div></header><section id="hero" class="submit-banner"></section><section class="sub-tab-section"><div class="container"><div class="row"><div class="col-md-12"><div class="tab"><a href="https://www.techunifi.com/timesheet.html" class="sub-tablinks active">English</a><a href="https://www.techunifi.com/timesheet-spanish.html" class="sub-tablinks">Espanol</a></div></div></div><div class="row"><div class="col-md-12"><div id="sub-tab2" class="sub-tabcontent"><div class="sub-tab2-section"><section class="ticket-form"><div class="container"><div class="row"><div class="col-md-12"><div class="form-parent"><div class="submit-head-para"><div class="prod-heading aos-init"><h3>Contractor Time Sheet</h3></div><p class="tabs-para aos-init" style="line-height:2;font-weight:500">Instructions for the Timesheet:<br>After completing a property's timesheet, submit it before starting the next one.<br>If you need help, message or call me at<a href="tel:336-601-6502" style="padding:0;color:#2a7aff;text-decoration:underline">336-601-6502</a>.</p></div><form id="timesheet-form" action="https://crm.zoho.com/crm/WebForm" name="WebForm6771280000000928341" method="POST" enctype="multipart/form-data" onsubmit='return document.charset="UTF-8",checkMandatory6771280000000928341()' accept-charset="UTF-8"><input type="text" style="display:none" name="xnQsjsdp" value="dcc6d3e607347c5d8d5e65ad88669411e31c68227b4266befd636c428582ef52"><input type="hidden" name="zc_gad" id="zc_gad" value=""><input type="text" style="display:none" name="xmIwtLD" value="086ce6471a7963008e59974b5343dc3ad13ba386fdc9badcaa560542db2b9c419b3cb3d44e32db78fd7dd4188ba56cfb"><input type="text" style="display:none" name="actionType" value="Q3VzdG9tTW9kdWxlMQ=="><input type="text" style="display:none" name="returnURL" value="https&#x3a;&#x2f;&#x2f;www.techunifi.com&#x2f;thanku-submit.html"><input type="text" value="NA" style="display:none" id="NAME" aria-required="true" aria-label="NAME" name="NAME" aria-valuemax="120" maxlength="120"><div class="submit-sub-section submit-contact-info"><div class="row"><div class="col-md-12"><br><br><label for="COBJ1CF1">Your Name</label><input id="COBJ1CF1" name="COBJ1CF1" placeholder="Enter your Name" maxlength="40" size="20" type="text" required></div></div><div class="row"><div class="col-md-12"><label for="COBJ1CF2">Property Name</label><input id="COBJ1CF2" name="COBJ1CF2" placeholder="Property Name" maxlength="40" size="20" type="text" required></div></div><div class="row"><div class="col-md-12"><label for="COBJ1CF4">Description</label><textarea id="COBJ1CF4" name="COBJ1CF4" rows="7" placeholder="Enter Work Details" onkeydown='13===event.keyCode&&(event.preventDefault(),this.value+="\n")' required></textarea></div></div><div class="row"><div class="col-md-6"><label for="COBJ1CF66">Receipt</label><input id="COBJ1CF66" placeholder="$4.32" name="COBJ1CF66" size="20" type="number" step="any"></div><div class="col-md-6"><label for="theFile6771280000000928341" id="imageUploadField" class="attach-receipt-button" class=""><img src="assets/img/attach_file.svg" alt="Attach Icon" class="button-icon">Attach Image of Receipt</label><input type="file" class="zcwf_file hidden-file-input" style="margin:0" name="theFile" aria-multiselectable="true" aria-labelledby="imageUploadField" id="theFile6771280000000928341" multiple="multiple"><p style="color:red;font-size:11px;padding-left:12px;padding-top:4px;margin-bottom:15px">File(s) size limit is 20MB.</p></div></div><div class="row"><div class="col-md-6"><label for="COBJ1CF116">Date - Time in</label><div class="zcwf_col_fld"><input type="text" id="COBJ1CF116" aria-required="false" aria-label="COBJ1CF116" name="COBJ1CF116" aria-valuemax="120" maxlength="120" ftype="date" placeholder="DD/MM/YYYY" aria-placeholder="DD/MM/YYYY" tplid="6771280000000928341COBJ1CF116" onfocus="formCalender.stEv(event),formCalender.createCalendar(this)" autocomplete="off" required><div id="template6771280000000928341COBJ1CF116" onclick="formCalender.stEv(event)" class="tempCalDiv"></div><div class="timesheet-date-time"><select role="combobox" aria-haspopup="listbox" style="padding:0" name="COBJ1CF116hour"><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select><select name="COBJ1CF116minute" role="combobox" aria-haspopup="listbox" style="padding:0"><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select><select name="COBJ1CF116ampm" role="combobox" aria-haspopup="listbox" style="padding:0"><option value="AM">AM</option><option value="PM">PM</option></select></div><div class="zcwf_col_help"></div></div></div><div class="col-md-6"><label for="COBJ1CF117">Date - Time Out</label><div class="zcwf_col_fld"><input type="text" id="COBJ1CF117" aria-required="false" aria-label="COBJ1CF117" name="COBJ1CF117" aria-valuemax="120" maxlength="120" ftype="date" placeholder="DD/MM/YYYY" aria-placeholder="DD/MM/YYYY" tplid="6771280000000928341COBJ1CF117" onfocus="formCalender.stEv(event),formCalender.createCalendar(this)" autocomplete="off" required><div id="template6771280000000928341COBJ1CF117" onclick="formCalender.stEv(event)" class="tempCalDiv"></div><div class="timesheet-date-time"><select role="combobox" aria-haspopup="listbox" style="padding:0" name="COBJ1CF117hour"><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select><select name="COBJ1CF117minute" role="combobox" aria-haspopup="listbox" style="padding:0"><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select><select name="COBJ1CF117ampm" role="combobox" aria-haspopup="listbox" style="padding:0"><option value="AM">AM</option><option value="PM">PM</option></select></div><div class="zcwf_col_help"></div></div></div></div><div class="row"><div class="col-md-6"><label for="COBJ1CF3">Total Travel Hours</label><input id="COBJ1CF3" placeholder="4" name="COBJ1CF3" size="20" type="number" step="any" required></div><div class="col-md-6"><label for="COBJ1CF5">Total Labor Hours</label><input id="COBJ1CF5" placeholder="4" name="COBJ1CF5" size="20" type="number" step="any" required></div></div><div class="row" style="padding-bottom:20px"><div class="col-md-12"><div class="zcwf_col_lab"></div><div class="zcwf_col_fld"><div class="g-recaptcha" data-sitekey="6Lf3ICYqAAAAAGHKnO2VfWsmWMcJ57vKk7KBusnz" data-theme="light" data-callback="rccallback6771280000000928341" captcha-verified="false" id="recap6771280000000928341"></div><div id="recapErr6771280000000928341" style="font-size:12px;color:red;visibility:hidden">Captcha validation failed. If you are not a robot then please try again.</div></div></div></div></div><div class="modal fade" id="reviewModal" tabindex="-1" aria-labelledby="reviewModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="reviewModalLabel">Review Your Details</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><div id="reviewDetails" class="list-group"></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Edit Form</button><button type="button" class="btn btn-primary" id="confirmSubmit">Confirm & Submit</button></div></div></div></div><div class="post-form-para"><p>Be sure to review the form before submitting. Please provide as much detail as possible so that we can tailor our service to your needs.</p></div><div class="row"><div class="col-md-12 flex justify-content-center"><input type="submit" id="formsubmit" name="submitButton" class="formsubmit zcwf_button" value="Submit & Download"></div></div><style>#calenDiv{padding:10px;display:table;font-family:helvetica,sans-serif!important}.calNav{width:20px;height:15px;display:inline-block;position:relative;top:4px;cursor:pointer}#calenDiv .calNav{width:15px}#calenDiv .yearNavLft{right:10px}#calenDiv .yearNavRgt{left:10px}#calenDiv .dLft{right:5px}#calenDiv .dRgt{left:5px}.dLft{right:10px;opacity:.8}.dRgt{left:10px;opacity:.8}.yearNavLft{right:15px}.yearNavRgt{left:15px;opacity:.6}#calenDiv table.calDay{border-spacing:6px;margin-top:0;border-collapse:unset}#calenDiv table.calDay td{padding:3px 4px;font-size:11px}#calenDiv table.calDay th{padding:0 3px;font-size:11px;padding-right:0;padding-left:1px;color:#888;width:27px;cursor:default;border-radius:3px;text-align:center;font-weight:400}#calenDiv #weekDays{margin-top:10px;margin-bottom:5px;border-top:1px solid #c0c6cc;border-bottom:1px solid #c0c6cc;border-spacing:5px;margin-left:0;color:#8b9ab9}#calenDiv .sCalMon{cursor:default;display:inline-block;color:#888;width:110px;font-size:12px}table.calDay td:hover{background-color:#e8e8e8}table.calDay{color:#222;margin-left:-10px;border-spacing:12px}table.calDay td,table.calDay th{font-size:var(--crm-extra-medium-font-size);cursor:default;border-radius:3px;text-align:center;padding:3px 5px;font-family:helvetica,sans-serif!important}table.calDay td.sel,table.calDay td.sel:hover{color:#fff;background:#b3b3b3;border-radius:3px}table.calDay td.lt-gray,table.calDay td.noNum{color:#c1c1c1}.aligncenter{text-align:center}#calBtns a,.lyteCalBtns .lyteCalCurrentDate a{color:var(--linkColor);font-size:14px;text-decoration:none}#calenDiv #calBtns{width:183px;margin-left:10px;border-top:0;font-size:11px;padding:3px 0 12px!important}.arrow{border:solid #666;border-width:0 1px 1px 0;display:inline-block;height:6px;width:6px}#calenDiv .right{transform:rotate(-45deg);-webkit-transform:rotate(-45deg)}#calenDiv .left{transform:rotate(135deg);-webkit-transform:rotate(135deg)}.mLMinus2{margin-left:-2px}.mRMinus2{margin-right:-2px}.vaM{vertical-align:middle}.tempCalDiv{display:none;margin:0;position:absolute;z-index:1000;background-color:#fff;border:1px solid #c0c6cc;-webkit-box-shadow:0 2px 10px rgba(0,0,0,.3);box-shadow:0 2px 10px rgba(0,0,0,.3);border-top:0;width:100%;max-width:225px}.sub-tab2-section .ticket-form form .timesheet-date-time select{min-height:unset;overflow-y:auto}.timesheet-date-time{display:flex}</style></form><div id="loader" class="d-none text-center"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div><p class="mt-2">Submitting...</p></div></div></div></div></div></section></div></div></div></div></div></section><div class="chat-bot"><button id="chatbotIcon" onclick="toggleChat()">💬</button><div id="chatPopup" class="card"><p>Tech<span>unifi</span></p><div class="card-body d-flex flex-column" id="chatbox"><div class="chat-bubble bot">Hi, I'm the chatbot. How can I help you today? Would you like to know more about our<a href="https://www.techunifi.com/#landing-services" target="_blank">Services</a>,<a href="https://www.techunifi.com/products.html" target="_blank">Products</a>, or<a href="https://www.techunifi.com/inquiry.html" target="_blank">Inquire</a>about your needs?</div></div><div class="card-footer"><div class="input-group"><input type="text" id="userInput" class="form-control" placeholder="Type a message..."><button class="btn btn-primary" onclick="sendMessage()">Send</button></div></div></div></div><footer class="footer" role="contentinfo"><div class="container"><div class="row"><div class="col-md-2 col-lg-2 col-xl-2 mb-4 mb-md-0 about-us" id="aboutUs"><ul class="list-unstyled links-footer"><li><a href="index.html#landing-services">Services</a></li><li><a href="index.html#how-it-works">How It Works</a></li><li><a href="products.html">Products</a></li><li><a href="about.html">About Us</a></li><li><a href="index.html#contact">Contact Us</a></li></ul></div><div class="col-md-2 col-lg-2 col-xl-2 mb-4 mb-md-0 footer-prod-services"><ul class="list-unstyled links-footer"><li><p>Quick Links</p></li><li><a href="products.html?section=low-Voltage">Low Voltage</a></li><li><a href="products.html?section=telecom">Telecom</a></li><li><a href="products.html?section=security">Security</a></li><li><a href="products.html?section=wifi">Network</a></li><li><a href="products.html?section=audi-vide">Audio & Video</a></li><li><a href="products.html?section=light">Lighting</a></li><li><a href="products.html?section=energy">Energy</a></li><li><a href="products.html?section=other-info">IT Management</a></li></ul></div><div class="col-md-5 col-lg-5 col-xl-5 mb-4 mb-md-0 what-we-do"><h3>What We Do</h3><p>Techunifi is a leading provider of comprehensive IT solutions, renowned for its commitment to excellence, innovation, and fostering enduring client partnerships.</p><ul class="list-unstyled connect-details location-details"><li><h3>Location</h3><a href="javascript:void(0)">2638 Willard Dairy Road, Suite 112 High Point, NC 27265</a></li></ul></div><div class="col-md-3 col-lg-3 col-xl-3 ms-auto"><div class="row site-section pt-0"><div class="col-md-12 mb-4 mb-md-0 social-us"><h3>Get In Touch</h3><div class="row"><ul class="list-unstyled connect-details"><li><a href="tel:+1 (336) 860-6061"><span class="bi bi-telephone"></span>+1 (336) 860-6061</a><br><a href="mailto: office-admin@techunifi.com"><span class="bi bi-envelope"></span>info@techunifi.com</a></li></ul></div><div class="row email-sub-row d-none"><div class="col-md-12"><h3>Stay in Touch</h3><form action="" method="post" role="form" class="email-subscribe"><label>Subscribe to our email listing</label><input type="email" class="subscribe-mail form-control" name="email" id="form-email" placeholder="Email" required=""><button type="submit">Subscribe</button></form></div></div><div class="row"><div class="col-md-12"><h3 class="above-social">Stay Connected</h3><ul class="list-unstyled"><li><p class="social"><a href="https://www.facebook.com/Techunifi-105965585242387"><span class="bi bi-facebook"></span></a><a href="https://twitter.com/techunifi"><span class="bi bi-twitter-x"></span></a><a href="https://www.linkedin.com/company/techunifi"><span class="bi bi-linkedin"></span></a><a href="https://www.instagram.com/techunifi/"><span class="bi bi-instagram"></span></a><a href="https://www.pinterest.com/techunifi/"><span class="bi bi-pinterest"></span></a></p></li></ul></div></div></div></div></div></div><div class="row"><div class="col-md-12" style="padding-top:30px"><div class="copy-right"><a href="https://www.techunifi.com/"><img src="assets/img/hero-img.svg" title="techunifi" alt="logo"></a><p>@ Techunifi 2024</p></div></div></div></div></footer><a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a><script src="assets/vendor/purecounter/purecounter_vanilla.js"></script><script src="assets/vendor/aos/aos.js"></script><script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script><script src="assets/vendor/swiper/swiper-bundle.min.js"></script><script src="assets/js/main.js"></script><script>// =========================================================
// 1. Core Utilities (dateFormatConvert and formCalender)
//    - These are already well-defined and can remain mostly as is.
// =========================================================

var formCalender = {
    userPattern: 'YYYY-MM-DD',
    currDateObj: void 0,
    currMonth: void 0,
    currYear: void 0,
    currDate: void 0,
    currMonthEnd: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],
    monthName: void 0,
    days: void 0,
    displayPanel: void 0,
    isHideToday: void 0,
    calDefColor: '#515CCB',
    weekdays: {
        1: 'Sunday',
        2: 'Monday',
        3: 'Tuesday',
        4: 'Wednesday',
        5: 'Thursday',
        6: 'Friday',
        7: 'Saturday'
    },
    months: {
        1: 'January',
        2: 'February',
        3: 'March',
        4: 'April',
        5: 'May',
        6: 'June',
        7: 'July',
        8: 'August',
        9: 'September',
        10: 'October',
        11: 'November',
        12: 'December'
    },
    init: function() {
        this.monthName = [{
            html: 'January',
            value: 0
        }, {
            html: 'February',
            value: 1
        }, {
            html: 'March',
            value: 2
        }, {
            html: 'April',
            value: 3
        }, {
            html: 'May',
            value: 4
        }, {
            html: 'June',
            value: 5
        }, {
            html: 'July',
            value: 6
        }, {
            html: 'August',
            value: 7
        }, {
            html: 'September',
            value: 8
        }, {
            html: 'October',
            value: 9
        }, {
            html: 'November',
            value: 10
        }, {
            html: 'December',
            value: 11
        }], this.days = ['ssunday', 'smonday', 'stuesday', 'swednesday', 'sthursday', 'sfriday', 'ssaturday'], this.dayNamesShort = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'], this.daysBasedOnPrefernce = ['ssunday', 'smonday', 'stuesday', 'swednesday', 'sthursday', 'sfriday', 'ssaturday'];
        var e = this.daysBasedOnPrefernce[0];
        this.daysBasedOnPrefernce.shift(1), this.daysBasedOnPrefernce.push(e);
        var t = this.dayNamesShort[0];
        this.dayNamesShort.shift(1), this.dayNamesShort.push(t), this.currDateObj = new Date, this.currMonth = this.currDateObj.getMonth(), this.currYear = this.currDateObj.getFullYear(), this.currYear < 1e3 && (this.currYear += 1900), this.currDate = this.currDateObj.getDate()
    },
    getTitle: function() {
        return this.monthName[this.currMonth].html + ' ' + this.currYear
    },
    createCalendar: function(e) {
        for (var t = document.getElementsByClassName('tempCalDiv'), a = t.length, r = 0; r < a; r++) {
            var n = t[r].style;
            'block' === n.display && (n.display = 'none')
        }
        this.calendarNode = e, this.userPattern = this.calendarNode.placeholder;
        var s = this.calendarNode.value,
            i = !1;
        if (s) {
            var l = dateFormatConvert.validate(s, this.userPattern);
            l && (this.currDate = l.getDate(), this.currMonth = l.getMonth(), this.currYear = l.getFullYear(), this.currYear < 1e3 && (this.currYear = Number(this.currYear) + 1900))
        } else i = !0, formCalender.init();
        this.monthName || formCalender.init(), this.createDatePicker(this.currDate, this.currMonth, this.currYear, i, !1)
    },
    createDatePicker: function(e, t, a, r, n) {
        1 === this.currMonth && (this.currMonthEnd[1] = this.currYear % 400 == 0 || this.currYear % 4 == 0 && this.currYear % 100 != 0 ? 29 : 28);
        var s = new Date(a, t, 1),
            i = 6,
            l = this.daysBasedOnPrefernce.indexOf(this.days[s.getDay()]) + 1;
        i = 31 === this.currMonthEnd[t] && l >= 6 || 30 === this.currMonthEnd[t] && 7 === l ? 7 : 28 === this.currMonthEnd[t] && 1 === l ? 5 : 6;
        var d = this.getTitle(e, a, t),
            o = this.dayNamesShort,
            h = '<div id=\'calenDiv\'><i id=\'calArrow\' style=\'display:none;\' class=\'dIB SocialArrow\'></i><div><div>';
        h += '<div class=\'aligncenter\'><span class=\'calNav dIB vaM yearNavLft\' onclick=\'formCalender.updateDatePicker(event,undefined, -1)\'><i class=\'arrow left mRMinus2\'></i><i class=\'arrow left\'></i></span><span class=\'calNav dLft dIB vaM\' onClick=\'formCalender.updateDatePicker(event,-1)\' id=\'pm\'><i class=\'arrow left\'></i></span><span class=\'sCalMon\'>' + d + '</span><span class=\'calNav dRgt vaM\' onClick =\'formCalender.updateDatePicker(event,1)\' id=\'nm\'><i class=\'arrow right\'></i></span><span class=\'calNav dIB vaM yearNavRgt\' onclick=\'formCalender.updateDatePicker(event,undefined, 1)\'><i class=\'arrow right\'></i><i class=\'arrow right mLMinus2\'></i></span></div>', h += '<table  class=\'calDay\'  id =\'weekDays\' style=\'color:#8b9ab9; font-size:8px; margin-left:0\'><tr> <th>' + o[0] + '</th> <th>' + o[1] + '</th><th>' + o[2] + '</th><th>' + o[3] + '</th> <th>' + o[4] + '</th> <th>' + o[5] + '</th> <th>' + o[6] + '</th></tr></table>', h += '</div>', h += '<table id=\'calHeader\' class=\'calDay\' style=\'margin-left:0; margin-top:-5px;\' width=\'100%\' cellspacing=\'0\' cellpadding=\'0\' border=\'0\' >';
        var c = '',
            u = new Date,
            y = a || u.getFullYear(),
            v = e || u.getDate(),
            g = void 0 === t ? u.getMonth() : t,
            m = u.getMonth(),
            p = u.getFullYear();
        u.getDate();
        m === t && a === p && (c = ' style=\'display:none\'');
        for (var f, D, M, b = s.getDay(); 1 !== b;) s.setDate(s.getDate() - 1), b = s.getDay();
        for (var x = 1; x <= i; x++) {
            h += '<tr>';
            for (var Y = 1; Y < 8; Y++) {
                f = s.getMonth(), D = s.getFullYear(), M = s.getDate(), D + '-' + (parseInt(f) + 1) + '-' + M;
                var F = 'cdate lt-gray';
                if (M === v && D === y && f === g && (F = 'cdate lt-gray'), f === g && (F = 'cdate'), (r && M === v && m === g && p === y || !n && M === v && f === g && D === y) && (F = 'sel'), n) {
                    var k = dateFormatConvert.validate(this.calendarNode.value, formCalender.userPattern);
                    k && M === k.getDate() && f === k.getMonth() && D === k.getFullYear() && (F = 'sel')
                }
                h += '<td class=\'' + F + '\' onClick=\'formCalender.displaySelectedDate(\"' + M + ' ' + f + ' ' + D + '\")\'>' + M + '</td>', s.setDate(s.getDate() + 1)
            }
            h += '</tr>'
        }
        h += '</table>', h += '<div>', this.isHideToday || (h += '<div id=\'calBtns\' class=\'pT15 pB15 fL\'><a' + c + ' class=\'cP fL\' href=\'javascript:;\' id=\'todayBtn\' onclick=\'formCalender.displaySelectedDate(\"today\")\'>Today</a>'), h += '</div>', h += '</div>', h += '</div></div>';
        var C = document.getElementById('template' + this.calendarNode.getAttribute('tplid'));
        C.innerHTML = h, C.style.display = 'block'
    },
    displaySelectedDate: function(e, t) {
        if (!t) t = this.calendarNode;
        if ('today' === e) {
            var a = new Date;
            e = a.getDate() + ' ' + a.getMonth() + ' ' + a.getFullYear()
        }
        e = e.split(' ');
        var r = dateFormatConvert.convertFormat(new Date(e[2], e[1], e[0]), this.userPattern);
        t.value = r, t.focus(), t.placeholder = this.userPattern, formCalender.closeDatePicker(), t.addEventListener('keyup', function(e) {
            formCalender.calendarNode = this;
            var t = this.value,
                a = dateFormatConvert.validate(t, formCalender.userPattern);
            if (a) {
                var r = {};
                r.date = a.getDate(), r.month = a.getMonth(), r.year = a.getFullYear(), formCalender.updateDatePicker(e, void 0, void 0, r)
            }
        }), t.blur()
    },
    closeDatePicker: function() {
        document.getElementById('template' + this.calendarNode.getAttribute('tplid')).style.display = 'none'
    },
    updateDatePicker: function(e, t, a, r) {
        var n = document.getElementById('template' + this.calendarNode.getAttribute('tplid'));
        r && (this.currDate = r.date, this.currMonth = r.month, this.currYear = r.year), void 0 !== t ? 1 === t ? 11 === this.currMonth ? (this.currMonth = 0, this.currYear++) : this.currMonth++ : 0 === this.currMonth ? (this.currMonth = 11, this.currYear--) : this.currMonth-- : void 0 !== a && (this.currYear = parseInt(this.currYear) + a), this.createDatePicker(this.currDate, this.currMonth, this.currYear, !1, !0), n.style.display = 'block'
    },
    stEv: function(e) {
        e || (e = window.event), e && (e.cancelBubble = !0, e.stopPropagation && e.stopPropagation())
    }
};

window.onclick = function() {
    for (var e = document.getElementsByClassName('tempCalDiv'), t = e.length, a = 0; a < t; a++) {
        var r = e[a];
        if (document.activeElement === document.querySelector('input[tplid=\'' + r.id.replace('template', '') + '\']')) return;
        var n = e[a].style;
        'block' === n.display && (n.display = 'none')
    }
};

var dateFormatConvert = {
    shortMon: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    longMon: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
    dayArr: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],
    wod: 1,
    lm: 'userdate',
    _dateObj: void 0,
    lLimit: 80,
    formats: [{
        val: 'YYYY',
        type: 'year',
        regex: /\d{4}/,
        len: 4
    }, {
        val: 'GGGG',
        type: 'year',
        regex: /\d{4}/,
        len: 4,
        isWEG: !0
    }, {
        val: 'gggg',
        type: 'year',
        regex: /\d{4}/,
        len: 4,
        isWEG: !0
    }, {
        val: 'YY',
        type: 'year',
        regex: /\d{2}/,
        len: 2
    }, {
        val: 'GG',
        type: 'year',
        regex: /\d{2}/,
        len: 2,
        isWEG: !0
    }, {
        val: 'gg',
        type: 'year',
        regex: /\d{2}/,
        len: 2,
        isWEG: !0
    }, {
        val: 'MMMM',
        type: 'month',
        regex: /[A-z]{3,}/,
        long: !0,
        str: !0,
        array: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
    }, {
        val: 'MMM',
        str: !0,
        type: 'month',
        regex: /[A-z]{3,}/,
        array: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    }, {
        val: 'Mo',
        suff: !0,
        type: 'month',
        regex: /\d{1,2}(?=st|nd|rd|th)/,
        max: 12
    }, {
        val: 'MM',
        type: 'month',
        regex: /\d{2}/,
        len: 2,
        max: 12,
        alt: !0
    }, {
        val: 'M',
        type: 'month',
        regex: /\d{1,2}/,
        max: 12
    }, {
        val: 'DDDD',
        type: 'date',
        regex: /\d{3}/,
        len: 3,
        year: !0
    }, {
        val: 'DDDo',
        type: 'date',
        suff: !0,
        regex: /\d{1,3}(?=st|nd|rd|th)/,
        len: 3,
        year: !0,
        ignore: /\d{3}(?=st|nd|rd|th)/
    }, {
        val: 'DDD',
        type: 'date',
        regex: /\d{1,3}/,
        year: !0,
        ignore: /\d{3}/
    }, {
        val: 'Do',
        type: 'date',
        suff: !0,
        regex: /\d{1,2}(?=st|nd|rd|th)/
    }, {
        val: 'DD',
        type: 'date',
        regex: /\d{2}/,
        len: 2,
        alt: !0
    }, {
        val: 'D',
        type: 'date',
        regex: /\d{1,2}/
    }, {
        val: 'dddd',
        type: 'longdate',
        regex: /[A-z]{3,}/,
        long: !0,
        str: !0,
        array: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
    }, {
        val: 'ddd',
        type: 'longdate',
        regex: /[A-z]{3}/,
        str: !0,
        array: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']
    }, {
        val: 'dd',
        type: 'longdate',
        regex: /[A-z]{2}/,
        str: !0,
        array: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa']
    }, {
        val: 'do',
        type: 'longdate',
        regex: /\d{1}(?=st|nd|rd|th)/,
        suff: !0
    }, {
        val: 'd',
        type: 'longdate',
        regex: /\d{1}/}
    ],
    parseFormat: function(e, t) {
        for (var a, r = this.formats, n = [], s = r.length, i = 0; i < s; i++) {
            var l = r[i];
            if (!e.length) break;
            if (e.indexOf(l.val) > -1) {
                if (t && l.alt) {
                    a = !0;
                    continue
                }
                a && (l.val = r[i - 1].val, l = r[i - 1]), a = !1, n.push({
                    format: l,
                    index: e.indexOf(l.val)
                }), e = e.replace(l.val, Math.pow(10, l.val.length - 1)), i--
            }
        }
        return n.sort(function(e, t) {
            return e.index - t.index
        })
    },
    convertFormat: function(e, t) {
        this._dateObj = e;
        var a = this._dateObj,
            r = this.parseFormat(t, !0),
            n = {},
            s = {
                date: a.getDate(),
                month: a.getMonth(),
                year: a.getFullYear(),
                day: a.getDay()
            };
        t = this.fmReplace(t.replace(/{{|}}/g, ''), r);
        for (var i = r.length, l = 0; l < i; l++) {
            var d = r[l].format;
            switch (d.type) {
                case 'date':
                    t = t.replace(d.val + this.lm, this.crctLength(d.year ? this.totdate(s.month, this.isLeap(s.year), s.date) : s.date, d.len, d.suff));
                    break;
                case 'month':
                    t = d.str ? t.replace(d.val + this.lm, d.array[s.month]) : t.replace(d.val + this.lm, this.crctLength(s.month + 1, d.len, d.suff));
                    break;
                case 'year':
                    t = t.replace(d.val + this.lm, 2 === d.len ? this.crctLength(s.year % 100, 2) : 4 === (s.year + '').length ? s.year : this.crctLength(s.year, 4)), n.year = n.year || [], n.year.push(d);
                    break;
                case 'day':
                case 'week':
                    n.flag = !0, n[d.type] = n[d.type] || [], n[d.type].push(d);
                    break;
                case 'longdate':
                    t = d.str ? t.replace(d.val + this.lm, d.array[s.day]) : t.replace(d.val + this.lm, this.crctLength(s.day, null, d.suff))
            }
        }
        return t.replace(/{{|}}/g, '')
    },
    fmReplace: function(e, t) {
        for (var a = 0, r = t.length, n = 0; n < r; n++) e = e.slice(0, t[n].index + a) + t[n].format.val + this.lm + e.slice(t[n].index + a + t[n].format.val.length), a += 8;
        return e
    },
    totdate: function(e, t, a) {
        for (var r = 0, n = 0; n < e; n++) r += this.dayArr[n], t && 1 === n && (r += 1);
        return r + (a || 0)
    },
    crctLength: function(e, t, a) {
        var r = '';
        if (a && (r = this.nthconv(e)), t) {
            e = e.toString();
            for (var n = 1; n < t; n++) e.length <= n && (e = '0' + e)
        }
        return e + r
    },
    nthconv: function(e) {
        if (e > 3 && e < 21) return 'th';
        switch (e % 10) {
            case 1:
                return 'st';
            case 2:
                return 'nd';
            case 3:
                return 'rd';
            default:
                return 'th'
        }
    },
    isLeap: function(e) {
        return 2 === (e += '').length && (e = this.getCorrectYear(parseInt(e))), (e = parseInt(e)) % 4 == 0 && e % 100 != 0 || e % 400 == 0
    },
    getCorrectYear: function(e) {
        var t = e + '';
        if (e = parseInt(e), 2 === t.length) {
            var a = (new Date).getFullYear(),
                r = parseInt(a / 100),
                n = a % 100,
                s = (n - this.lLimit + 100) % 100;
            e = n > s ? e < s ? r + 1 + '' + this.crctLength(e, 2) : r + '' + this.crctLength(e, 2) : e < s ? r + '' + this.crctLength(e, 2) : r - 1 + '' + this.crctLength(e, 2)
        }
        return e
    },
    valFormat: function(e, t) {
        for (var a = {}, r = new Date((new Date).getFullYear(), 0), n = this.parseFormat(t, !0), s = e, i = t = t.replace(/{{|}}/g, ''), l = n.length, d = 0; d < l; d++) {
            var o, h = n[d].format;
            switch (h.type) {
                case 'date':
                case 'year':
                case 'week':
                case 'day':
                    h.regex.test(e) ? (o = 'year' === h.type ? e.match(h.regex)[h.match || 0] : parseInt(e.match(h.regex)[h.match || 0]), a[h.type] = o, e = this.replaceVal(e, h.regex, h.suff), s = this.replaceVal(s, h.regex, h.suff, h.val), h.year && (a.date = getDay(a.date).day)) : a.year && a.week ? (a[h.type] = this.wod, t = t.replace(h.val, ''), i = i.replace(h.val, '')) : a[h.type] = 'Invalid', /date/i.test(h.type) && 0 === a[h.type] && (a[h.type] = 'Invalid');
                    break;
                case 'month':
                    h.regex.test(e) ? (o = this.getMonth(e.match(h.regex)[0], h.suff, h.str, h.long), a.month = o.val, e = this.replaceVal(e, o.mon || h.regex, h.suff), s = this.replaceVal(s, o.mon || h.regex, h.suff, h.val)) : a.month = 'Invalid', a.month < 0 && (a.month = 'Invalid');
                    break;
                case 'longdate':
                    h.regex.test(e) && (o = h.str ? this.findVal(h.array, e.match(h.regex)[0]) : parseInt(e.match(h.regex)[0]), a.longdate = this.isDef(o.index) ? o.index : o, e = this.replaceVal(e, o.mon || o, h.suff), s = this.replaceVal(s, o.mon || o, h.suff, h.val))
            }
            t = t.replace(h.valForm || h.val, '')
        }
        if (this.isDef(a.longdate) && a.day && a.day !== a.longdate ? r.setFullYear('Invalid') : this.isDef(a.year) && r.setFullYear(this.getCorrectYear(a.year)), this.isDef(a.month) && r.setMonth(a.month), this.isDef(a.date) && r.setDate(a.date <= this.dayArr[r.getMonth()] + (1 === r.getMonth() && this.isLeap(r.getFullYear()) ? 1 : 0) ? a.date : 'Invalid'), this._isCorrectFormat = e.length === t.length && i === s && this.validate(r)) return r
    },
    validate: function(e, t) {
        var a = e.constructor;
        if (a === Date) return this._dateObj = e, 'Invalid Date' !== e.toString();
        if (a === String && t) {
            var r = this.valFormat(e, t);
            return r && this._isCorrectFormat && (this._format = t), r
        }
    },
    replaceVal: function(e, t, a, r) {
        return e = e.replace(t, r || ''), a && (e = e.replace(/st|nd|rd|th/, '')), e
    },
    getMonth: function(e, t, a, r) {
        var n;
        if (a) {
            var s = this.findVal(r ? this.longMon : this.shortMon, e);
            n = s.mon, e = s.index, (!n || e > 11) && (e = 'Invalid')
        } else(e = parseInt(e) - 1) > 11 && (e = 'Invalid');
        return {
            val: e,
            mon: n
        }
    },
    findVal: function(e, t) {
        var a, r, n = e.length;
        for (r = 0; r < n; r++)
            if (new RegExp(e[r]).test(t)) {
                a = e[r];
                break
            }
        return {
            mon: a,
            index: r
        }
    },
    isDef: function(e) {
        return void 0 !== e
    }
};


// =========================================================
// 2. Form Specific Validations & ReCAPTCHA
//    - Grouped for clarity, tied to specific form ID.
// =========================================================

// ReCAPTCHA Callbacks (assuming these are invoked by Google's reCAPTCHA script)
function rccallback6771280000000928341() {
    if (document.getElementById('recap6771280000000928341') != undefined) {
        document.getElementById('recap6771280000000928341').setAttribute('captcha-verified', !0)
    }
    if (document.getElementById('recapErr6771280000000928341') != undefined && document.getElementById('recapErr6771280000000928341').style.visibility == 'visible') {
        document.getElementById('recapErr6771280000000928341').style.visibility = 'hidden'
    }
}

function reCaptchaAlert6771280000000928341() {
    var recap = document.getElementById('recap6771280000000928341');
    if (recap != undefined && recap.getAttribute('captcha-verified') == 'false') {
        document.getElementById('recapErr6771280000000928341').style.visibility = 'visible';
        return !1
    }
    return !0
}

function validateDateFormat6771280000000928341() {
    var form = document.forms.WebForm6771280000000928341; // Assuming form name is 'WebForm6771280000000928341'
    var dateFlds = form.querySelectorAll('[ftype=date]');
    for (var i = 0; i < dateFlds.length; i++) {
        var dateFld = dateFlds[i];
        var usrPtrn = dateFld.placeholder;
        var dateVal = dateFld.value;
        if (dateVal.trim() != '') {
            var vald = dateFormatConvert.validate(dateVal, usrPtrn);
            if (!vald) {
                alert('Please enter a valid date.');
                dateFld.focus();
                return false;
            }
        }
    }
    return true;
}

function checkMandatory6771280000000928341() {
    var mndFileds = new Array('NAME'); // Ensure this matches your input names, e.g., 'userName' if that's the name attribute
    var fldLangVal = new Array('Timesheet Name');
    var form = document.forms.WebForm6771280000000928341; // Assuming form name is 'WebForm6771280000000928341'

    for (i = 0; i < mndFileds.length; i++) {
        var fieldObj = form[mndFileds[i]];
        if (fieldObj) {
            if (((fieldObj.value).replace(/^\s+|\s+$/g, '')).length == 0) {
                if (fieldObj.type == 'file') {
                    alert('Please select a file to upload.');
                    fieldObj.focus();
                    return !1
                }
                alert(fldLangVal[i] + ' cannot be empty.');
                fieldObj.focus();
                return !1
            } else if (fieldObj.nodeName == 'SELECT') {
                if (fieldObj.options[fieldObj.selectedIndex].value == '-None-') {
                    alert(fldLangVal[i] + ' cannot be none.');
                    fieldObj.focus();
                    return !1
                }
            } else if (fieldObj.type == 'checkbox') {
                if (fieldObj.checked == !1) {
                    alert('Please accept ' + fldLangVal[i]);
                    fieldObj.focus();
                    return !1
                }
            }
            try {
                if (fieldObj.name == 'Last Name') { // This specific check might need review
                    name = fieldObj.value
                }
            } catch (e) {}
        }
    }
    return !0;
}

function validateFileUpload6771280000000928341() {
    var uploadedFiles = document.getElementById('theFile6771280000000928341'); // Assuming 'fileAttach' input has this ID
    if (!uploadedFiles) return true; // No file input, so no validation needed

    var totalFileSize = 0;
    if (uploadedFiles.files.length > 3) {
        alert('You can upload a maximum of three files at a time.');
        return !1
    }
    if ('files' in uploadedFiles) {
        if (uploadedFiles.files.length != 0) {
            for (var i = 0; i < uploadedFiles.files.length; i++) {
                var file = uploadedFiles.files[i];
                if ('size' in file) {
                    totalFileSize = totalFileSize + file.size
                }
            }
            if (totalFileSize > 20971520) { // 20MB in bytes
                alert('Total file(s) size should not exceed 20MB.');
                return !1
            }
        }
    }
    return !0
}

function tooltipShow6771280000000928341(el) {
    var tooltip = el.nextElementSibling;
    var tooltipDisplay = tooltip.style.display;
    if (tooltipDisplay == 'none') {
        var allTooltip = document.getElementsByClassName('zcwf_tooltip_over');
        for (i = 0; i < allTooltip.length; i++) {
            allTooltip[i].style.display = 'none'
        }
        tooltip.style.display = 'block'
    } else {
        tooltip.style.display = 'none'
    }
}


// =========================================================
// 3. Main Form Logic (DOMContentLoaded)
//    - This is the primary entry point for your form's behavior.
// =========================================================

document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('timesheet-form'); // Ensure your form has this ID
    const reviewModal = new bootstrap.Modal(document.getElementById('reviewModal'));
    const reviewDetails = document.getElementById('reviewDetails');
    const confirmSubmitButton = document.getElementById('confirmSubmit');
    const loader = document.getElementById('loader');

    // Declare currentFormData in a scope accessible by both event listeners
    let currentFormData = {}; // This will hold the data for the review modal and PDF

    const fieldNameMapping = {
        userName: 'COBJ1CF1',
        propertyName: 'COBJ1CF2',
        description: 'COBJ1CF4',
        travelHours: 'COBJ1CF3',
        laborHours: 'COBJ1CF5',
        timeIn: 'COBJ1CF116',
        timeOut: 'COBJ1CF117',
        receipt: 'COBJ1CF66',
        // 'theFile' is the name of your file input, but we primarily use its ID 'theFile6771280000000928341' for direct access.
        // No need to map it here for `focus()` logic because we directly use its ID for that.
    };
    // -------------------------------------------------------------------------


    if (!form || !reviewModal || !reviewDetails || !confirmSubmitButton || !loader) {
        console.error("One or more required DOM elements for the timesheet form are missing.");
        return; // Exit if critical elements are not found
    }

    function showLoader() {
        loader.classList.remove('d-none');
        form.classList.add('d-none'); // Hide the form
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
        // Optional: Update loader text to show it's active
        loader.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Submitting...';
    }

    function hideLoader() {
        loader.classList.add('d-none');
        form.classList.remove('d-none'); // Show the form again
        loader.innerHTML = ''; // Clear loader text
    }

    function populateReviewModal(data) {
        reviewDetails.innerHTML = '';

        const dateInputName = fieldNameMapping.date;
        const fileInputId = 'theFile6771280000000928341'; // ID of your file input

        Object.entries(data).forEach(([key, value]) => {
            if (key === 'fileAttachDisplayName') { // Using a new key for just display purposes
                value = value || 'No file selected';
            } else if (key === 'fileAttach') { // This key won't be in `data` anymore for direct display
                return;
            }


            const item = document.createElement('div');
            item.classList.add('list-group-item'); // Assuming Bootstrap list-group-item for styling

            let displayKey = key.replace(/([A-Z])/g, ' $1').replace(/^./, (str) => str.toUpperCase());
            if (key.startsWith('COBJ1CF')) {
                displayKey = 'Field ' + key.replace('COBJ1CF', '').toUpperCase();
            } else if (key === 'date' && dateInputName) {
                displayKey = 'Date';
            } else if (key === 'fileAttachDisplayName') {
                displayKey = 'Attached Receipt';
            }

            const label = document.createElement('div');
            label.innerHTML = `<strong>${displayKey}:</strong> ${value || 'N/A'}`;

            const editIcon = document.createElement('i');
            editIcon.classList.add('bi', 'bi-pencil-square', 'text-primary', 'ms-2'); // Assumes Bootstrap Icons
            editIcon.style.cursor = 'pointer';
            editIcon.title = `Edit ${displayKey}`;

            editIcon.addEventListener('click', () => {
                let targetFieldName = fieldNameMapping[key];

                if (key === 'fileAttachDisplayName' && fileInputId) { // Use the display name to target the actual file input
                    const fileField = document.getElementById(fileInputId);
                    if (fileField) {
                        reviewModal.hide();
                        fileField.focus();
                        return;
                    }
                }

                if (targetFieldName) {
                    const field = form[targetFieldName] || document.getElementById(targetFieldName);
                    if (field) {
                        reviewModal.hide();
                        field.focus();
                    } else {
                        console.warn(`Edit icon: Could not find form element for key '${key}' with HTML name/ID '${targetFieldName}'.`);
                    }
                } else {
                    console.warn(`Edit icon: No mapping defined for form data key: '${key}'.`);
                }
            });
            item.appendChild(label);
            item.appendChild(editIcon);
            reviewDetails.appendChild(item);
        });
    }

    // Function to generate PDF
    function generatePDF(data) {
        const {
            jsPDF
        } = window.jspdf;
        if (!jsPDF) {
            console.error('jsPDF library is not loaded.');
            alert('Unable to generate PDF. Please ensure jsPDF is loaded before this script.');
            return;
        }

        const doc = new jsPDF();
        doc.setFontSize(16);
        doc.text('Contractor Timesheet', 10, 10);

        const tableData = [
            ['Name', data.userName],
            ['Property Name', data.propertyName],
            ['Description', data.description],
            ['Travel Hours', data.travelHours],
            ['Labor Hours', data.laborHours],
            ['Time In', data.timeIn],
            ['Time Out', data.timeOut],
            ['Receipt Amount', data.receipt],
        ];
        // Add file attachment display to PDF if present
        if (data.fileAttachDisplayName && data.fileAttachDisplayName !== 'No file selected') {
            tableData.push(['Attached File', data.fileAttachDisplayName]);
        }

        if (doc.autoTable) {
            doc.autoTable({
                startY: 20,
                head: [
                    ['Field', 'Details']
                ],
                body: tableData,
            });
        } else {
            console.error('autoTable plugin is not available. Please ensure jspdf-autotable is loaded.');
            alert('PDF generation failed due to missing plugin.');
            return;
        }

        // Add a 'date' field to your currentFormData if you want it in the PDF filename.
        // If your form has a date field, make sure to add it to fieldNameMapping and formData.
        // For now, assuming you might not have a specific 'date' field directly mapped to a variable.
        // If you do, ensure it's captured in `currentFormData`.
        const formattedDate = new Date().toISOString().slice(0,10).replace(/-/g,'_'); // Fallback to current date for filename
        // If you have a specific date field like `form.DATE_FIELD.value`, use it:
        // const formattedDate = currentFormData.date ? currentFormData.date.replace(/-/g,'_') : new Date().toISOString().slice(0,10).replace(/-/g,'_');

        doc.save(`timesheet.pdf`);
    }

    // Main form submission handler
    form.addEventListener('submit', async (event) => {
        event.preventDefault(); // Prevent default HTML form submission initially

        // Run all client-side validations FIRST
        if (!checkMandatory6771280000000928341()) {
            return;
        }
        if (!validateDateFormat6771280000000928341()) {
            return;
        }
        if (!validateFileUpload6771280000000928341()) {
            return;
        }

        // ReCAPTCHA check (ensure grecaptcha is globally available)
        const recaptchaResponse = typeof grecaptcha !== 'undefined' ? grecaptcha.getResponse() : null;
        if (!recaptchaResponse) {
            alert('Please complete the CAPTCHA before submitting.');
            return;
        }
        // Also call the internal reCAPTCHA alert for visibility
        if (!reCaptchaAlert6771280000000928341()) {
            return;
        }

        // Gather form data for review and PDF (store in currentFormData)
        const fileInputForValidation = document.getElementById('theFile6771280000000928341'); // Get file input here
        currentFormData = { // Store the data here so it's available later
            userName: form.COBJ1CF1.value.trim(),
            propertyName: form.COBJ1CF2.value.trim(),
            description: form.COBJ1CF4.value.trim(),
            travelHours: form.COBJ1CF3.value.trim(),
            laborHours: form.COBJ1CF5.value.trim(),
            timeIn: form.COBJ1CF116.value.trim(),
            timeOut: form.COBJ1CF117.value.trim(),
            receipt: form.COBJ1CF66.value.trim(),
            // Add a display name for the file, not the file object itself
            fileAttachDisplayName: fileInputForValidation && fileInputForValidation.files[0] ? fileInputForValidation.files[0].name : '',
            // If you have a date field that you want in the PDF, add it here:
            // date: form.DATE_FIELD_NAME.value.trim(),
        };

        // Conditional check for receipt attachment
        if (currentFormData.receipt && (!fileInputForValidation || !fileInputForValidation.files[0])) {
            alert('Please attach the receipt image if a receipt amount is entered.');
            if (fileInputForValidation) {
                fileInputForValidation.focus();
            }
            return;
        }

        // Populate and show the review modal
        populateReviewModal(currentFormData); // Pass the stored data
        reviewModal.show();
    });

    // Confirm submission from the review modal
    confirmSubmitButton.addEventListener('click', async () => {
        reviewModal.hide();
        showLoader(); // Show loader immediately upon confirm

        // --- Prepare FormData for Zoho Submission ---
        const zohoFormData = new FormData(form); // Creates FormData from the actual HTML form

        // --- Handle File Attachment for Zoho (if present) ---
        const fileInput = document.getElementById('theFile6771280000000928341'); // <--- CONFIRM THIS ID MATCHES YOUR FILE INPUT
        if (fileInput && fileInput.files[0]) {
            // Append the file directly to zohoFormData using its name attribute
            zohoFormData.append('theFile', fileInput.files[0]);
        }
        // --- Add reCAPTCHA response to FormData ---
        const recaptchaResponse = typeof grecaptcha !== 'undefined' ? grecaptcha.getResponse() : null;
        if (recaptchaResponse) {
            zohoFormData.append('g-recaptcha-response', recaptchaResponse);
        }

        console.log("Attempting to submit form to Zoho..."); // Debugging message

        // --- Actual Form Submission to Zoho (Programmatic Submit) ---
        try {
            // Store original form attributes
            const originalAction = form.action;
            const originalMethod = form.method;
            const originalTarget = form.target;

            // Set attributes for Zoho submission (Zoho usually expects POST)
            form.method = 'POST'; // Ensure it's POST

            const iframe = document.createElement('iframe');
            iframe.name = 'zohoSubmitFrame';
            iframe.style.display = 'none'; // Hide the iframe
            document.body.appendChild(iframe);
            form.target = iframe.name; // Target the hidden iframe

            // Listen for the iframe load event to detect submission completion (success or failure)
            iframe.onload = function() {
                hideLoader();
                alert('Submitted Successfully!!and Data will download.'); // Updated alert message

                // Clean up the iframe after a short delay
                setTimeout(() => {
                    document.body.removeChild(iframe);
                    // Reset form target
                    form.target = originalTarget;
                    // Reset form method
                    form.method = originalMethod; // Restore original method too
                }, 1000); // Give it a moment to process

                form.reset(); // Clear form fields AFTER we've used the data for the PDF

                // Use the `currentFormData` that was captured BEFORE `form.reset()`
                generatePDF(currentFormData); // Generate PDF locally with the captured data

                if (typeof grecaptcha !== 'undefined' && grecaptcha.reset) {
                    grecaptcha.reset(); // Reset reCAPTCHA
                }
            };

            iframe.onerror = function() {
                hideLoader();
                alert('An error occurred during Zoho form submission (iframe load error). Please try again.');
                console.error('Zoho form iframe error.');
                // Reset form attributes
                form.action = originalAction;
                form.method = originalMethod;
                form.target = originalTarget;
                if (typeof grecaptcha !== 'undefined' && grecaptcha.reset) {
                    grecaptcha.reset();
                }
            };

            form.enctype = 'multipart/form-data'; // Crucial for file uploads

            // Ensure your form's submit button or any element inside it is NOT named 'submit'
            // If it is, change it (e.g., name="submitButton") to avoid 'form.submit is not a function' error.
            form.submit(); // This calls the native form submission
        } catch (error) {
            console.error('Unexpected error during form submission setup:', error);
            alert('An unexpected error occurred during form submission setup. Please try again.');
            hideLoader();
            // Reset reCAPTCHA if something went wrong before actual submission
            if (typeof grecaptcha !== 'undefined' && grecaptcha.reset) {
                grecaptcha.reset();
            }
        }
    });
    // ---------------------------------------------


    // Handle 'smarturl' parameter for form pre-population (as per original script)
    var urlparams = new URLSearchParams(window.location.search);
    if (urlparams.has('service') && (urlparams.get('service') === 'smarturl')) {
        var webform = document.getElementById('webform6771280000000928341'); // Ensure this ID is correct for your form
        if (webform) {
            var service = urlparams.get('service');
            var smarturlfield = document.createElement('input');
            smarturlfield.setAttribute('type', 'hidden');
            smarturlfield.setAttribute('value', service);
            smarturlfield.setAttribute('name', 'service'); // Zoho expects 'service' parameter
            webform.appendChild(smarturlfield);
        }
    }

    // Disable submit button initially (as per original script, though often done on successful submission)
    const submitButton = document.querySelector('.crmWebToEntityForm .formsubmit');
    if (submitButton) {
        // You might consider enabling/disabling this based on form validity or other conditions
        // submitButton.setAttribute('disabled', true); // Removed as it conflicts with UX on initial load
    }
});</script><script id="wf_anal" src="https://crm.zohopublic.com/crm/WebFormAnalyticsServeServlet?rid=f307e3c4c05ac87cfd9bc73a6fdac996f09d22c47df19e78d79a3a6d1c8ff58e2093d601738850fd42f968fd835c03efgid9ea01b1f3753ffe6a680a9d874f9e3a204f7519d4c26e9ccd48b37eda1f84e81gide4b3077a16c544cc8461c74f271246e50f6cf1c35b9678eaa2b09f8aeffd4f6fgid5c13c5209dbe3304413406de310e45ee7a446b78f4059bb003ac824af32b26dc&tw=ec99bad902d6fe8636bf3f5e3104d34e0366025f7501225e448a74a230579296"></script></body></html>
